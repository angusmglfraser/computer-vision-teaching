!function(t){var e={};function r(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:a})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=7)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r(2);e.RGBImage=a.RGBImage;var i,n=r(1);function o(t,e,r,i){for(var n=t.getWidth(),o=t.getHeight(),h=a.RGBImage.fromDimensions(n,o),g=Math.floor(r/2),s=Math.floor(i/2),u=0;u<n;u++)for(var f=0;f<o;f++){for(var d=0,c=0;c<r;c++)for(var b=0;b<i;b++)d+=e[c][b]*t.r[Math.abs(u+g-c)%n][Math.abs(f+s-b)%o];h.r[u][f]=h.g[u][f]=h.b[u][f]=d}return h}function h(t,e){for(var r=a.RGBImage.fromDimensions(t.getWidth(),t.getHeight()),i=a.RGBImage.fromDimensions(t.getWidth(),t.getHeight()),n=Math.floor(e.length/2),o=0;o<t.getWidth();o++)for(var h=0;h<t.getHeight();h++){for(var g=0,s=0,u=0,f=0;f<e.length;f++)g+=e[f]*t.r[Math.abs(o+n-f)%t.getWidth()][h],s+=e[f]*t.g[Math.abs(o+n-f)%t.getWidth()][h],u+=e[f]*t.b[Math.abs(o+n-f)%t.getWidth()][h];i.r[o][h]=Math.abs(g),i.g[o][h]=Math.abs(s),i.b[o][h]=Math.abs(u)}for(o=0;o<t.getWidth();o++)for(h=0;h<t.getHeight();h++){for(g=0,s=0,u=0,f=0;f<e.length;f++)g+=e[f]*i.r[o][Math.abs(h+n-f)%t.getHeight()],s+=e[f]*i.g[o][Math.abs(h+n-f)%t.getHeight()],u+=e[f]*i.b[o][Math.abs(h+n-f)%t.getHeight()];r.r[o][h]=Math.abs(g),r.g[o][h]=Math.abs(s),r.b[o][h]=Math.abs(u)}return r}function g(t,e){for(var r=t.getWidth(),i=t.getHeight(),n=a.RGBImage.fromDimensions(r,i),o=0;o<r;o++)for(var h=0;h<r;h++){var g=t.r[o][h],s=e.r[o][h],u=t.g[o][h],f=e.g[o][h],d=t.b[o][h],c=e.b[o][h];n.r[o][h]=Math.floor(Math.sqrt(g*g+s*s)),n.g[o][h]=Math.floor(Math.sqrt(u*u+f*f)),n.b[o][h]=Math.floor(Math.sqrt(d*d+c*c))}return n}e.MovingAverageBackgroundSubtractor=n.MovingAverageBackgroundSubtractor,e.gaussKernel=[[1/273,4/273,7/273,4/273,1/273],[4/273,16/273,26/273,16/273,4/273],[7/273,26/273,41/273,26/273,7/273],[4/273,16/273,26/273,16/273,4/273],[1/273,4/273,7/273,4/273,1/273]],e.gauss1d=[.06136,.24477,.38774,.24477,.06136],e.sobelX=[[1,0,-1],[2,0,-2],[1,0,-1]],e.sobelY=[[1,2,1],[0,0,0],[-1,-2,-1]],function(t){t[t.NO_EDGE=0]="NO_EDGE",t[t.WEAK_EDGE=1]="WEAK_EDGE",t[t.STRONG_EDGE=2]="STRONG_EDGE"}(i||(i={})),e.getImageFromCanvas=function(t){return a.RGBImage.fromImageData(t.getContext("2d").getImageData(0,0,t.width,t.height))},e.getImageFromVideo=function(t,e,r){void 0===r&&(r=1);var i=t.videoWidth*r,n=t.videoHeight*r;return e.getContext("2d").drawImage(t,0,0,i,n),a.RGBImage.fromImageData(e.getContext("2d").getImageData(0,0,i,n))},e.convolve=function(t,e,r,i){for(var n=t.getWidth(),o=t.getHeight(),h=a.RGBImage.fromDimensions(n,o),g=Math.floor(r/2),s=Math.floor(i/2),u=0;u<t.getWidth();u++)for(var f=0;f<t.getHeight();f++){for(var d=0,c=0,b=0,l=0;l<r;l++)for(var v=0;v<i;v++)d+=e[l][v]*t.r[Math.abs(u+g-l)%n][Math.abs(f+s-v)%o],c+=e[l][v]*t.g[Math.abs(u+g-l)%n][Math.abs(f+s-v)%o],b+=e[l][v]*t.b[Math.abs(u+g-l)%n][Math.abs(f+s-v)%o];h.r[u][f]=d,h.g[u][f]=c,h.b[u][f]=b}return h},e.greyscaleConvolve=o,e.convolve1d=h,e.combineConvolutions=g,e.initCamera=function(){navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){var e=document.getElementById("webcam");e.srcObject=t,e.addEventListener("playing",function(t){for(var r=document.getElementsByTagName("canvas"),a=0;a<r.length;a++)r[a].width=e.videoWidth,r[a].height=e.videoHeight})}).catch(function(t){var e=t.name,r=e;switch(e){case"NotSupportedError":r+="\nIf you are using Google Chrome, try changing the 'http' at the start of the url to 'https', or using a different web browser, such as Firefox";break;case"NotReadableError":r+="\nPlease make sure that your webcam is connected and enabled, and not currently being used by another application.";break;case"NotAllowedError":return}alert(r)})},e.getForeground=function(t,e,r){e=e.greyScale();for(var i=t.greyScale(),n=a.RGBImage.fromDimensions(t.getWidth(),t.getHeight()),o=0;o<t.getWidth();o++)for(var h=0;h<t.getHeight();h++)Math.abs(i.r[o][h]-e.r[o][h])>r&&(n.r[o][h]=t.r[o][h],n.g[o][h]=t.g[o][h],n.b[o][h]=t.b[o][h]);return n},e.getBackground=function(t,e,r){e=e.greyScale();for(var i=t.greyScale(),n=a.RGBImage.fromDimensions(t.getWidth(),t.getHeight()),o=0;o<t.getWidth();o++)for(var h=0;h<t.getHeight();h++)Math.abs(i.r[o][h]-e.r[o][h])<r&&(n.r[o][h]=t.r[o][h],n.g[o][h]=t.g[o][h],n.b[o][h]=t.b[o][h]);return n},e.imageDiff=function(t,e){for(var r=a.RGBImage.fromDimensions(e.getWidth(),e.getHeight()),i=0;i<e.getWidth();i++)for(var n=0;n<e.getHeight();n++){var o=Math.abs(e.r[i][n]-t.r[i][n]),h=Math.abs(e.g[i][n]-t.g[i][n]),g=Math.abs(e.b[i][n]-t.b[i][n]);r.r[i][n]=o,r.g[i][n]=h,r.b[i][n]=g}return r},e.getCannyEdges=function(t,r,n){var s=h(t=t.greyScale(),e.gauss1d),u=o(s,e.sobelX,3,3),f=o(s,e.sobelY,3,3);return function(t){for(var e=t.length,r=t[0].length,n=a.RGBImage.fromDimensions(e,r),o=0;o<e;o++)for(var h=0;h<r;h++)switch(t[o][h]){case i.STRONG_EDGE:n.r[o][h]=n.g[o][h]=n.b[o][h]=255;break;case i.WEAK_EDGE:for(var g=!1,s=0,u=o-1;u<=o+1;u++){for(var f=h-1;f<=h+1;f++)if(t[Math.abs(u)%e][Math.abs(f)%r]===i.STRONG_EDGE){g=!0,s=255;break}if(g)break}n.r[o][h]=n.g[o][h]=n.b[o][h]=s;break;default:n.r[o][h]=n.g[o][h]=n.b[o][h]=0}return n}(function(t,e,r){for(var a=new Array(t.getWidth()),n=Math.max(e,r),o=Math.min(e,r),h=0;h<t.getWidth();h++){a[h]=new Array(t.getHeight());for(var g=0;g<t.getHeight();g++)t.r[h][g]>n?a[h][g]=i.STRONG_EDGE:t.r[h][g]>o?a[h][g]=i.WEAK_EDGE:a[h][g]=i.NO_EDGE}return a}(function(t,e){for(var r=a.RGBImage.fromDimensions(t.getWidth(),t.getHeight()),i=0;i<t.getWidth();i++)for(var n=0;n<t.getHeight();n++){var o=e[i][n];o<22.5?t.r[i][n]==Math.max(t.r[(i+1)%t.getWidth()][n],t.r[Math.abs(i-1)][n],t.r[i][n])?r.r[i][n]=r.g[i][n]=r.b[i][n]=t.r[i][n]:r.r[i][n]=r.g[i][n]=r.b[i][n]=0:o<67.5?t.r[i][n]==Math.max(t.r[i][n],t.r[(i+1)%t.getWidth()][(n+1)%t.getHeight()],t.r[Math.abs(i-1)][Math.abs(n-1)])||t.r[i][n]==Math.max(t.r[i][n],t.r[(i+1)%t.getWidth()][Math.abs(n-1)],t.r[Math.abs(i-1)][(n+1)%t.getHeight()])?r.r[i][n]=r.g[i][n]=r.b[i][n]=t.r[i][n]:r.r[i][n]=r.g[i][n]=r.b[i][n]=0:t.r[i][n]==Math.max(t.r[i][(n+1)%t.getHeight()],t.r[i][Math.abs(n-1)],t.r[i][n])?r.r[i][n]=r.g[i][n]=r.b[i][n]=t.r[i][n]:r.r[i][n]=r.g[i][n]=r.b[i][n]=0}return r}(g(u,f),function(t,e){for(var r=new Array(t.getWidth()),a=0;a<t.getWidth();a++){r[a]=new Array(t.getHeight());for(var i=0;i<t.getHeight();i++){var n=180*Math.atan2(t.r[a][i],e.r[a][i])/Math.PI;r[a][i]=n}}return r}(u,f)),r,n))}},function(t,e,r){"use strict";var a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=a(r(0)),n=function(){function t(t){this.buffer=new h,this.capacity=t,this.currentBackground=null}return t.prototype.addFrame=function(t){var e=this.buffer.getSize();if(null==this.currentBackground)this.currentBackground=t,this.buffer.add(t);else{var r=void 0;if(this.buffer.getSize()<this.capacity){r=i.RGBImage.clone(this.currentBackground);for(var a=0;a<t.getWidth();a++)for(var n=0;n<t.getHeight();n++)r.r[a][n]*=e,r.g[a][n]*=e,r.b[a][n]*=e,r.r[a][n]+=t.r[a][n],r.g[a][n]+=t.g[a][n],r.b[a][n]+=t.b[a][n]}else{r=i.RGBImage.clone(this.currentBackground);var o=this.buffer.removeFirstNode();for(a=0;a<t.getWidth();a++)for(n=0;n<t.getHeight();n++)r.r[a][n]*=e,r.g[a][n]*=e,r.b[a][n]*=e,r.r[a][n]-=o.r[a][n],r.g[a][n]-=o.g[a][n],r.b[a][n]-=o.b[a][n],r.r[a][n]+=t.r[a][n],r.g[a][n]+=t.g[a][n],r.b[a][n]+=t.b[a][n]}this.buffer.add(t);for(a=0;a<t.getWidth();a++)for(n=0;n<t.getHeight();n++)r.r[a][n]/=this.buffer.getSize(),r.g[a][n]/=this.buffer.getSize(),r.b[a][n]/=this.buffer.getSize();this.currentBackground=r}},t.prototype.getBackgroundModel=function(){return this.currentBackground},t.prototype.setBufferSize=function(t){if(t>this.buffer.getSize())this.capacity=t;else{for(this.capacity=t;this.buffer.getSize()>this.capacity;)this.buffer.removeFirstNode();this.recalculateBackgroundModel()}},t.prototype.recalculateBackgroundModel=function(){for(var t=new o(this.buffer),e=i.RGBImage.fromDimensions(this.currentBackground.getWidth(),this.currentBackground.getHeight());t.hasNext();)for(var r=t.next(),a=0;a<this.currentBackground.getWidth();a++)for(var n=0;n<this.currentBackground.getHeight();n++)e.r[a][n]+=r.r[a][n],e.g[a][n]+=r.g[a][n],e.b[a][n]+=r.b[a][n];for(a=0;a<this.currentBackground.getWidth();a++)for(n=0;n<this.currentBackground.getHeight();n++)e.r[a][n]=e.r[a][n]/this.buffer.getSize(),e.g[a][n]=e.g[a][n]/this.buffer.getSize(),e.b[a][n]=e.b[a][n]/this.buffer.getSize()},t}();e.MovingAverageBackgroundSubtractor=n;var o=function(){function t(t){this.currentNode=t.getFirstNode()}return t.prototype.hasNext=function(){return null!=this.currentNode.next&&void 0!=this.currentNode.next},t.prototype.next=function(){var t=this.currentNode.data;return this.currentNode=this.currentNode.next,t},t}(),h=function(){function t(){this.size=0}return t.prototype.add=function(t){0==this.size?(this.first=new g(t),this.last=this.first):(this.last.next=new g(t),this.last.next.previous=this.last,this.last=this.last.next),this.size++},t.prototype.removeFirstNode=function(){var t=this.first.data;return this.first=this.first.next,this.first.previous.next=null,this.first.previous=null,this.size--,t},t.prototype.removeLastNode=function(){var t=this.last.data;return this.last=this.last.previous,this.last.next.previous=null,this.last.next=null,this.size--,t},t.prototype.getFirstNode=function(){return this.first},t.prototype.getLastNode=function(){return this.last},t.prototype.getSize=function(){return this.size},t}(),g=function(){return function(t){this.data=t,this.previous=null,this.next=null}}()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(){}return t.getIndex=function(t,e,r,a){return r*e+t},t.fromDimensions=function(e,r){var a=new t;a.width=e,a.height=r,a.r=new Array(e),a.g=new Array(e),a.b=new Array(r);for(var i=0;i<e;i++)a.r[i]=new Array(r),a.g[i]=new Array(r),a.b[i]=new Array(r);return a},t.fromImageData=function(e){var r=new t;r.width=e.width,r.height=e.height,r.r=new Array(r.width),r.g=new Array(r.width),r.b=new Array(r.width);for(var a=0;a<r.width;a++){r.r[a]=new Array(r.height),r.g[a]=new Array(r.height),r.b[a]=new Array(r.height);for(var i=0;i<r.height;i++){var n=4*t.getIndex(a,i,r.width,r.height);r.r[a][i]=e.data[n++],r.g[a][i]=e.data[n++],r.b[a][i]=e.data[n]}}return r},t.clone=function(e){var r=new t;r.width=e.width,r.height=e.height,r.r=new Array(r.width),r.g=new Array(r.width),r.b=new Array(r.width);for(var a=0;a<r.width;a++){r.r[a]=new Array(r.height),r.g[a]=new Array(r.height),r.b[a]=new Array(r.height);for(var i=0;i<r.height;i++)r.r[a][i]=e.r[a][i],r.g[a][i]=e.g[a][i],r.b[a][i]=e.b[a][i]}return r},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.asImageData=function(){for(var e=new ImageData(this.width,this.height),r=0;r<this.width;r++)for(var a=0;a<this.height;a++){var i=4*t.getIndex(r,a,this.width,this.height);e.data[i++]=this.r[r][a],e.data[i++]=this.g[r][a],e.data[i++]=this.b[r][a],e.data[i]=255}return e},t.prototype.draw=function(t){var e=this.asImageData();t.getContext("2d").putImageData(e,0,0)},t.prototype.greyScale=function(){for(var e=t.fromDimensions(this.width,this.height),r=0;r<e.width;r++)for(var a=0;a<e.height;a++){var i=(this.r[r][a]+this.g[r][a]+this.b[r][a])/3;e.r[r][a]=e.g[r][a]=e.b[r][a]=i}return e},t}();e.RGBImage=a},,,,,function(t,e,r){"use strict";var a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=a(r(0)),n=!1;function o(){var t=i.getImageFromVideo(document.getElementById("webcam"),document.getElementById("camfeed"));i.getCannyEdges(t,+document.getElementById("lowerThreshold").value,+document.getElementById("upperThreshold").value).draw(document.getElementById("cannyoutput")),n&&requestAnimationFrame(o)}document.getElementById("stopBtn").addEventListener("click",function(t){n=!1}),document.getElementById("startBtn").addEventListener("click",function(t){n=!0,o()}),i.initCamera()}]);
//# sourceMappingURL=canny.js.map